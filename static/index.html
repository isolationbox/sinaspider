<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" type="text/css" href="css/H-ui.css" />
		<link rel="stylesheet" type="text/css" href="css/my.css" />
		<link rel="stylesheet" type="text/css" href="lib/Hui-iconfont/iconfont.css" />
		<script type="text/javascript" src="lib/jquery/jquery.js"></script>
		<title>股票网站</title>
	</head>
	<body>
	<!-- 顶部标题-->
	<header class="navbar navbar-black">
		<span class="title">股票网站</span>
	</header>
	<!-- 左侧导航栏 -->
	<aside class="Hui-aside">
		<div class="menu_dropdown">
			<ul>
				<li><a href="index.html">大盘指数</a></li>
			</ul>
			<dl>
				<dt>沪市<i class="Hui-iconfont menu_dropdown-arrow">&#xe6d5;</i></dt>
				<dd>
					<ul>
						<li><a href="index.html?node=sh_a">A股</a></li>
						<li><a href="index.html?node=sh_b">B股</a></li>
					</ul>
				</dd>
			</dl>
			<dl>
				<dt>深市<i class="Hui-iconfont menu_dropdown-arrow">&#xe6d5;</i></dt>
				<dd>
					<ul>
						<li><a href="index.html?node=sz_a">A股</a></li>
						<li><a href="index.html?node=sz_b">B股</a></li>
					</ul>
				</dd>
			</dl>
		</div>
	</aside>

	<section class="Hui-article-box my-container">
		<article class="cl pd-20" style="border:1px solid #ddd; margin: 30px; border-radius: 5px;">
		<!-- 首页表格 -->
			<table class="table table-border table-bg table-hover">
				<caption id="caption">最近交易日股票数据</caption>
				<thead><tr style="background-color:#f0f0f0;">
					<th>股票名称</th><th>股票代码</th><th>交易日期</th><th>开盘</th><th>昨收</th><th>最高</th><th>最低</th><th>交易额</th>
				</tr></thead>
				<tbody id="table">
				</tbody>
			</table>
		</article>
		<!-- 底部信息 -->
		<footer class="footer mt-20">
			<div class="container-fluid">
				<span>感谢使用Copyright&copy;2018</span>
			</div>
		</footer>
	</section>
	<script type="text/javascript" src="js/H-ui.js"></script>
	<script>
		function GetQueryString(name) {
			var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
			var r = window.location.search.substr(1).match(reg);
			return r ? unescape(r[2]) : null;
		}
		var node = GetQueryString('node') || 'dpzs';
		var nameMap = {
			dpzs: '大盘指数',
			sh_a: '沪市A股',
			sh_b: '沪市B股',
			sz_a: '深市A股',
			sz_b: '深市B股'
		}
		document.getElementById('caption').innerHTML = nameMap[node] + '最新交易数据'
		$(document).ready(function() {
			// 监听下拉菜单
			$(".Hui-aside").Huifold({
				titCell:'.menu_dropdown dl dt',
				mainCell:'.menu_dropdown dl dd',
			});
			$.ajax({
				url: '/api/getlastinfo',
				type: 'POST',
				data: {
					page: 1,
					num: 20,
					node: node
				},
				success: function(result,status,xhr) {
					result = JSON.parse(result);
					console.log(result, status);
					if (status === 'success' && result.error === false) {
						var i, j, out = '';
						for(i = 0; i < result.data.length; i++) {
							out += '<tr>';
							for(j = 0; j < result.data[i].length; j++) {
								out += '<td>' + result.data[i][j] + '</td>';
							}
							out += '</tr>';
						}
						document.getElementById('table').innerHTML = out;
					} else {
						alert('系统出了一点小问题');
					}
				}
			});
		});
	</script>
	</body>
</html>